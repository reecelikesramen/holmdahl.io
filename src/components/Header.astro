---
import { Moon, Sun } from 'lucide-react';
import Navigation from './Navigation.astro';
import SearchButton from './SearchButton';
import { createAbsoluteUrl } from '@/utils/paths';

interface Props {
  title?: string;
  showThemeToggle?: boolean;
}

const { title = "holmdahl.io", showThemeToggle = true } = Astro.props;
---

<header class="flex flex-col py-2 sm:py-4 pl-3.5 pr-0 md:pl-6 md:pr-2">
  <nav class="flex flex-col xs:flex-row xs:justify-between xs:items-center max-w-screen-lg w-full justify-self-center place-self-center gap-2 xs:gap-0">
    <!-- Left side: Site title and theme toggle -->
    <div class="flex items-center gap-0 sm:gap-2">
      <a href={createAbsoluteUrl('/')} accesskey="h" title={`${title} (Alt + H)`} class="text-lg sm:text-2xl font-extrabold no-underline text-(--primary-color)">
        {title}
      </a>
      
      <!-- Theme toggle next to site title -->
      {showThemeToggle && (
        <button id="theme-toggle" accesskey="t" title="Toggle theme (Alt + T)" aria-label="Toggle theme" class="bg-transparent border-none cursor-pointer p-1">
          <Moon className="moon-icon w-5 h-5" />
          <Sun className="sun-icon w-5 h-5" />
        </button>
      )}
    </div>
    
    <!-- Right side: Navigation and Search -->
    <div class="flex items-center gap-2 justify-start sm:justify-end">
      <Navigation currentPath={Astro.url.pathname} />
      <SearchButton client:load />
    </div>
  </nav>
</header>

<script is:inline>
  // Theme toggle functionality
  function toggleTheme() {
    if (document.documentElement.classList.contains("dark")) {
      document.documentElement.classList.remove("dark");
      localStorage.setItem("theme", "light");
    } else {
      document.documentElement.classList.add("dark");
      localStorage.setItem("theme", "dark");
    }
  }
  
  document.getElementById("theme-toggle")?.addEventListener("click", toggleTheme);
</script>

<style>
  .moon-icon {
    display: block;
  }
  
  .sun-icon {
    display: none;
  }
  
  html.dark .moon-icon {
    display: none;
  }
  
  html.dark .sun-icon {
    display: block;
  }
</style> 