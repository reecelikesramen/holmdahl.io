---
import SocialIcons from './SocialIcons.astro';
import { ProfileImage } from './ProfileImage';
import { ButtonLink } from '@/components/ui/button-link';
import { createAbsoluteUrl, isExternalUrl } from '@/utils/paths';

interface ButtonConfig {
  name: string;
  url: string;
}

interface Props {
  imageUrl?: string;
  imageTitle?: string;
  imageWidth?: number;
  imageHeight?: number;
  title: string;
  email?: string;
  subtitle?: string;
  socialIcons?: {
    name: string;
    url: string;
    title?: string;
  }[];
  buttons?: ButtonConfig[];
}

const {
  imageUrl,
  imageTitle = 'profile image',
  imageWidth = 200,
  imageHeight = 200,
  title,
  email,
  subtitle,
  socialIcons = [],
  buttons = [],
} = Astro.props;
---

<div class="flex flex-1 justify-center items-center text-center">
  <div class="flex flex-col items-center gap-1">
    {imageUrl && (
      <ProfileImage 
        client:load
        src={isExternalUrl(imageUrl) ? imageUrl : createAbsoluteUrl(imageUrl)} 
        alt={imageTitle} 
        title={imageTitle}
        width={imageWidth} 
        height={imageHeight} 
      />
    )}
    <div class="flex flex-col items-center gap-2">
      <h1 class="text-3xl font-bold m-0" style="color: var(--primary-color)">{title}</h1>
      {email && <span class="text-lg" style="color: var(--secondary-color)">{email}</span>}
      {subtitle && <span class="text-lg font-medium mt-2" style="color: var(--primary-color)">{subtitle}</span>}
    </div>
    
    {socialIcons.length > 0 && (
      <div class="mt-2">
        <SocialIcons icons={socialIcons} />
      </div>
    )}
    
    {buttons.length > 0 && (
      <div class="flex flex-wrap justify-center gap-4 mt-6">
        {buttons.map(button => {
          const cleanUrl = button.url.trim();
          const isExternal = isExternalUrl(cleanUrl);
          return (
            <a 
              class="rounded-lg px-4 py-1.5 font-medium text-base transition-transform hover:scale-[0.98] hover:no-underline no-underline" 
              style="background: var(--tertiary-color); color: var(--primary-color);"
              href={isExternal ? cleanUrl : createAbsoluteUrl(cleanUrl)} 
              rel={isExternal ? "noopener noreferrer" : "noopener"}
              target={isExternal ? "_blank" : undefined}
              title={button.name}
            >
              {button.name}
            </a>
          );
        })}
      </div>
    )}
  </div>
</div> 