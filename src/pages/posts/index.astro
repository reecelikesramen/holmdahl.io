---
import MainLayout from '../../layouts/MainLayout.astro';
import PostsList from '../../components/PostsList.astro';
import { getCollection } from 'astro:content';

// Get all posts and sort by date
const posts = await getCollection("posts");
const sortedPosts = posts
  .filter((post) => !post.data.draft)
  .sort((a: any, b: any) => 
    new Date(b.data.pubDate).getTime() - 
    new Date(a.data.pubDate).getTime()
  )
  .map((post) => ({
    title: post.data.title,
    url: `/posts/${post.slug}`,
    description: post.data.description,
    pubDate: new Date(post.data.pubDate),
    draft: post.data.draft,
    tags: post.data.tags || [],
    readingTime: post.data.readingTime
  }));
---

<MainLayout title="Posts | holmdahl.io" description="Articles and thoughts">
  <div class="container mx-auto py-4">
    <h1 class="text-4xl font-bold">Posts</h1>
  </div>

  <div class="container mx-auto">
    <PostsList posts={sortedPosts} />
  </div>
</MainLayout> 